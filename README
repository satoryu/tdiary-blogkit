See README.en if you cannot read Japanese.




-- tDiary Blogkit: tDiaryをblog風に運用する --

■はじめに
　tDiary Blogkitは、tDiaryをweblogのように日単位でなく記事単位で管理
するシステムに改造するキットです。Blogkitを全面的に適用したtDiaryは、
日記システムとしてのtDiaryに対して、以下のような違いを持ちます。

- 日付が意味を持たなくなる(記事番号扱いになる)
- 記事に「最終更新時刻(Last-Modified)」が付くようになる
- リスト表示時には、記事の最初のセクションだけが表示される(似非サマリ)
- 「更新」を選ぶと、自動的に空いている記事番号を割り当ててくれる
- Recent EntoriesやWhat's Newで更新情報が公開される
- なにやら英語っぽい表記になる

　tDiary Blogkitは、tDiaryには影響を与えずに、すべてファイル追加のみ
で導入できます。

■インストール
　すでにtDiaryはインストール済みだとします。tDiaryは1.5.1もしくはそ
れ以降のできるだけ新しいものを推奨します。すでに運用中の日記ではなく、
新たにblog系サイトを作るという前提で説明します。すでに運用中の日記に
適用する場合には、tdiary.confのマージ作業などが必要になります。

1. tdiary.confを作成
  付属のtdiary.conf.sampleを、tDiaryのインストールディレクトリにtdiary.conf
  としてコピーします。そして、@data_pathをデータの保存場所に書き換え
  ます。詳しくはtDiaryのドキュメントを参照してください。
  付属のサンプルには、ヘッダやフッタなどにblog風のレイアウト指定が施さ
  れています。これらのカスタマイズは、運用開始後に設定画面から行ってく
  ださい。

2. IOクラスをコピー
  tdiary/blogio.rbを、tDiaryインストールディレクトリのtdiaryの下にコピー
  します。上のtdiary.confに「require 'tdiary/blogio'」の指定があるはず
  なので、確認してください。

2. テーマをコピー
  theme/blogを、tDiaryのインストールディレクトリにあるthemeにコピーしま
  す。このblogテーマはtDiaryの標準的テーマですが、サイドバーを使ったレイ
  アウトのための設定や、blog用プラグインのための設定が追加されています。

3. プラグインをコピー
  pluginに入っているプラグインファイルから、必要なものを選んで、tDiaryの
  インストールディレクトリにあるpluginにコピーします。プラグインの説明は
  「■プラグイン」を参照してください。

4. あとはtDiary同様に動かすだけ
  記事を追加するときには、画面下の「Update」をクリックします。日付は最新
  のものが自動的に入るので、「Update」時には常に新しい記事の追加になりま
  す。また、既存の記事の編集は、その記事を開いてから画面下の「Edit」をク
  リックすることで行えます。

■プラグイン解説
　ここでは各プラグインの概要のみ解説します。指定方法などは個々のプラグイ
ンファイルを見てください。

1. archive.rb
  1.1 archiveプラグイン
    過去記事一覧を表示します。サイドバーにデフォルトで配置されています。
    記事はグループ化されており(ようするに月単位ですが、Blogkitでは日付に
    意味がないので00001からの連番です)、新しい順に表示します。

  1.2 archive_dropdownプラグイン
    archiveと同様の一覧を、ドロップダウンリストで表示します。

2. blog-style.rb
  輸入版weblogツール風に、各所の文字列が英語になったりしています。シャレ
  なのであまり気にしてはいけません:-)
  pluginディレクトリにコピーするだけで機能します。

3. edit.rb
  記事単体表示の時に、UpdateボタンをEditボタンにするプラグインです。
  pluginディレクトリにコピーするだけで機能します。

4. lm.rb
  Last-Modifiedを表示するプラグインです。タイトル下か、記事最下部のどちら
  に表示するか、tdiary.confで選択可能です。
  pluginディレクトリにコピーするだけで機能します。

5. recent-entry.rb
  5.1 recent-entryプラグイン
    最新の記事一覧を、新しい順に表示します。このプラグインはrecent-entry2
    とは排他です。どちらか一方を選択してください。
    こちらのrecent-entryは、secureモードでも動く軽量版ですが、最新表示の場
    合にしか正しい表示を行えません。最新表示でのみサイドバーを表示するので
    あれば、こちらを使います。

6. recent-entry2.rb
  6.1 recent-entryプラグイン
    最新の記事一覧を、新しい順に表示します。このプラグインはrecent-entryと
    は排他です。どちらか一方を選択してください。
    こちらのrecent-entryは、secureモードででは動きませんが、月別・記事別表
    示でも常に正しいリストを表示します。最新表示以外でもサイドバーを表示す
    るのであれば、こちらを使います。

7. title-navi.rb
  tDiaryでは「前日」「翌日」になっていたナビゲーションボタンを、記事のタイ
  トルで置き換えます。ただし、月をまたぐ場合には、「Prev」「Next」という表
  記になります。
  pluginディレクトリにコピーするだけで機能します。

8. whatsnew-list.rb
  8.1 whatsnew-listプラグイン
    記事が更新された順に一覧表示を行います。recent-entryと違い、過去の記事
    を更新しても上位に入れ替わります。secureモードでは動きません。

■ライセンス
　GPLの元で改造、配布が可能です。作者はただただし<sho@spc.gr.jp>です。
Blogkitに関する最新情報は、http://www.tdiary.org/で得られます。
